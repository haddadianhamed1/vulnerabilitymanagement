import csv
from pprint import pprint
from collections import defaultdict
import glob

x= glob.glob("/root/set15-2016/*.csv")
d = defaultdict()
for items in x:
	with open(items, 'rb') as f:
		reader = csv.DictReader(f, delimiter=',')
		for row in reader:
			a =row["Vulnerability Title"]
			b =row["Vulnerability Severity Level"]
			c =row["Asset IP Address"]
			d.setdefault(c, []).append(a)
	f.close()
#pprint(d, indent=6, width=10)
#for row in d:
#	print row
with open('results/ipaddress.csv', 'wb') as csv_file:
	writer = csv.writer(csv_file)
	for key, value in d.items():
	  writer.writerow([key,value])
